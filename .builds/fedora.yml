# build manifest for SourceHut
# https://man.sr.ht/builds.sr.ht/
# use bionic as it's the last distribution to include tacacs+ package
image: fedora/latest
packages:
- autoconf
- libtool
- automake
- pam-devel
- openssl-devel
- clang
- clang-analyzer
- libasan
- libubsan
- gnulib
sources:
- https://git.sr.ht/~kravietz/pam-tacplus
tasks:
- gcc: |
        cd pam-tacplus
        gnulib-tool --import  fcntl crypto/md5 array-list list xlist getrandom realloc
        autoreconf -f -i -v
        scan-build --use-cc=gcc ./configure --enable-asan
        scan-build --use-cc=gcc make clean all
- clang: |
        cd pam-tacplus
        autoreconf -f -i -v
        scan-build --use-cc=clang ./configure --enable-asan
        scan-build --use-cc=clang make clean all